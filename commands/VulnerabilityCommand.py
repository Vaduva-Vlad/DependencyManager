from commands.Command import Command
from security.VulnerabilityChecker import VulnerabilityChecker


class VulnerabilityCommand(Command):
    def __init__(self, project_path):
        Command.__init__(self,VulnerabilityChecker(project_path))

    def run(self, args):
        if args.pkg_vuln:
            pkg_name,version=args.pkg_vuln.split(",")
            self.module.report_vulnerabilities(pkg_name,version)
        elif args.vuln:
            self.module.report_vulnerabilities()